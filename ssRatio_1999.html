<!DOCTYPE html>
<html>
  <head>
    <title>Legend Interaction Test</title>
    <meta charset="utf-8" />

    <script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-lite@5"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>

    <style media="screen">
      .vega-actions a {
        margin-right: 5px;
      }
    </style>
  </head>
  <body>
	<div id="vis"></div>
    <script>
    	// Assign the specification to a local variable vlSpec.
    	var vlSpec = {
            "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
            "title": {
                "text": "Source Sink Ratios for Individual Cohorts from 1999",
                "fontSize":16,
                "offset":20
            },
            "width": 400, "height": 200,
            "data": {
                "values": [
                    {"cohort": "UgandaRakai", "ss_ratio": 1.0},
                    {"cohort": "PartnerUganda", "ss_ratio": -1.0},
                    {"cohort": "MRCUganda", "ss_ratio": -0.704},
                    {"cohort": "PopartCopperbelt", "ss_ratio": -0.6},
                    {"cohort": "PopartSouthern", "ss_ratio": -1.0}
                ]
            },
            "encoding": {
                "y": {
                "field": "cohort", 
                "type": "nominal", 
                "sort": "-x", 
                "title": null,
                "axis": {"labelFontSize":12}
                },
                "x": {
                "field": "ss_ratio", 
                "type": "quantitative", 
                "title": null,
                "axis": {"labelFontSize":12},
                "scale": {"domain": [-1.0, 1.0]}
                }
            },
            "layer": [{
                "mark": "bar",
                "encoding": {
                "color": {
                    "field": "ss_ratio",
                    "type": "quantitative",
                    "title": "Source/Sink Ratio"
                }
                }
            }, {
                "mark": {
                "type": "text",
                "align": "center",
                "aria": false,
                "fontSize": 10
                },
                "encoding": {
                "text": {"field": "ss_ratio", "type": "quantitative"},
                "color": {
                    "condition": {
                    "test": {"field": "ss_ratio", "gt": 0},
                    "value": "red"
                    },
                    "value": "blue"
                }
                }
            }]
		};

     // Embed the visualization in the container with id `vis`
	vegaEmbed('#vis', vlSpec);

    </script>
  </body>
</html>